var emCommonTools={options:{cookies:false,footer:false},active:0,style:2,domains:["https:\/\/aulatest.educa.madrid.org\/","https:\/\/aulavirtualrrhh.educa.madrid.org\/","https:\/\/bachilleratodistancia.educa.madrid.org\/","https:\/\/campusinnovacion.educa.madrid.org\/","https:\/\/evaluacion.educa.madrid.org\/","https:\/\/formacion.educa.madrid.org\/","https:\/\/fpdistancia.educa.madrid.org\/","https:\/\/innovamooc.educa.madrid.org\/","https:\/\/mooc.centrosdeformacion.empleo.madrid.org\/","https:\/\/centrosdeformacion.empleo.madrid.org\/","https:\/\/aulavirtual*.educa.madrid.org"],msg:'<p>Durante el día de hoy necesitamos llevar a cabo labores de mantenimiento imprescindibles en las Aulas virtuales de EducaMadrid. Sentimos las molestias que este mantenimiento pueda ocasionar.<br />Las aulas virtuales de los centros no experimentarán corte del servicio total. No obstante durante algunos minutos pueden experimentarse, a lo largo de la mañana, pérdidas temporales de conexión que pueden afectar a la calidad del servicio.<br />Sin embargo, es necesario cortar el servicio totalmente durante algunas horas en las siguientes aulas virtuales de educa.madrid.org: aulatest, aulavirtualrrhh, bachilleratodistancia, campusinnovacion, centrosdeformacion, formacion, fpdistancia, innovamoocy  mooc.centrosdeformacion.</p>',cookieName:"EducaMadrid_Tmp_Warning",expires:1,cookieDomain:".madrid.org",baseURL:'https://avisos.educa.madrid.org/public/',cookieToolURL:'https://www.educa2.madrid.org/educamadrid/js/cookietool/manager/js/educamadrid.js',debug:0,lssiCookieName:'EducaMadrid_LSSI_Cookies',lssiExpires:30,init:function(){if(typeof(emRequiresCookies)=='boolean'&&emRequiresCookies==true)this.options.cookies=true;if(typeof(emCommonToolsOptions)=='object'){if(emCommonToolsOptions.cookies&&emCommonToolsOptions.cookies==true)this.options.cookies=true;if(emCommonToolsOptions.footer){var f=emCommonToolsOptions.footer;if(f=="white"||f=="dark"||f=="black")this.options.footer=f;else if(f==true)this.options.footer="white";}}
this.loadScript(this.baseURL+"news/css/common.css?v=20220920","emCommonToolsHandleInit");},handleInit:function(){if(this.options.footer!=false)this.footer();this.pass.init();var domains=this.domains;var active=false;if(domains.length>0){var currURL=window.location.href;for(var i=0;i<domains.length;i++){var domain=domains[i];if(currURL.indexOf(domain)==0||domain=="Plataforma"||(domain=="Portal"&&document.domain.indexOf(".madrid.org")!=-1&&typeof(Liferay)=='object')){active=true;}else{var dP=domain.split("*");if(dP.length==2){if(currURL.indexOf(dP[0])==0){var uP=currURL.replace(dP[0],"");uP=uP.replace(".","~");uP=uP.split("~");uP="."+uP[1];if(uP.indexOf(dP[1])==0){uP=currURL.replace(dP[0],"");uP=uP.split(".");uP=uP[0];if(!isNaN(uP))active=true;}}}}}}
if(active==false){this.active=false;}
if(!this.active){this.deleteWarningCookie();if(this.options.cookies){this.checkLSSIcookies();}
return;}
emCommonTools.handleMessages();},checkLSSIcookies:function(){var c=emCommonTools.getCookie(emCommonTools.lssiCookieName);if(!c||c=="-1"||window.location.href.indexOf("https://www.educa2.madrid.org/educamadrid/politica-de-cookies")==0){this.loadScript(this.cookieToolURL);}else{if(this.active)this.messages.init();if(c&&c!="2")this.loadScript(this.cookieToolURL);}},handleMessages:function(){if(this.options.cookies){this.checkLSSIcookies();}else{this.messages.init();}
if(this.debug==true)this.dev.start();},getHelpLink:function(){var l="https://documentacion.educa.madrid.org/"
var d=document.domain;if(typeof(d)!='string'||d==""||d.indexOf(".madrid.org")==-1)return l;if(d.indexOf("aulavirtual")==0||d.indexOf("formacion.")==0)l+="shelves/aula-virtual";else if(d.indexOf("cloud.")==0||d.indexOf("cloud2.")==0)l+="books/cloud";else if(d.indexOf("correoweb.")==0)l+="shelves/correo";else if(d.indexOf("formularios.")==0)l+="books/formularios---limesurvey";else if(d.indexOf("mediateca.")==0)l+="shelves/mediateca";else if(d.indexOf("site.")==0)l+="shelves/web-de-centro";else if(d.indexOf("portalcau.")==0)l+="books/portalcau";else if(d.indexOf("jitsi.")==0)l+="books/videoconferencia";return l;},footer:function(){var f=this.options.footer;var k="";var iA="ce";var iB="em";if(f=="dark"){k="emCommonFooterDark";iA=f+"/"+iA;iB=f+"/"+iB;}else if(f=="black"){k="emCommonFooterDark emCommonFooterBlack";iA=f+"/"+iA;iB=f+"/"+iB;}
var c='\<div id="emCommonFooterContent"><p id="emCommonFooterCopyright"><a href="https://www.educa2.madrid.org/educamadrid/"><strong>EducaMadrid</strong></a><span class="emCommonFooterSep"><span> - </span></span>Vicepresidencia, Consejería de Educación y Universidades<span class="emCommonFooterSep"><span> - </span></span><a id="emCommonFooterHelpLnk" href="'+this.getHelpLink()+'" target="_blank" rel="noopener" title="Documentación de EducaMadrid">Ayuda<span> (en ventana nueva)</span></a><span id="emCommonFooterLogos"><a href="https://www.comunidad.madrid/servicios/educacion" title="Comunidad de Madrid"><img src="https://avisos.educa.madrid.org/public/logos/footer/'+iA+'.png?v=202206" width="131" height="38" alt="Vicepresidencia, Consejería de Educación y Universidades"/></a><a href="https://www.educa2.madrid.org/educamadrid/" title="EducaMadrid"><img src="https://avisos.educa.madrid.org/public/logos/footer/'+iB+'.png?v=202206" width="131" height="38" alt="EducaMadrid, Plataforma Educativa"/></a></span></p></div>';var w=jQuery("#emCommonFooter");if(w.length==1){w.attr("class",k).html(c);return;}
jQuery("body").append('<div id="emCommonFooter" class="'+k+'">'+c+'</div>');},messages:{header:'<h2>Mantenimiento Aulas Virtuales</h2> <a href="#" id="emCommonMessageBtnClose" title="Cerrar">×<span> Cerrar el aviso</span></a> <p id="emCommonMessageLogo"><img src="%s" alt="EducaMadrid Plataforma Educativa" width="262" height="76" /></p>',footer:'<p class="emCommonMessageBtns"><a href="#" class="emCommonMessageBtn" id="emCommonMessageBtn">Aceptar</a></p>',getAddr:function(){var eA=[99,97,117,64,101,100,117,99,97,46,109,97,100,114,105,100,46,111,114,103];var e='';for(var i=0;i<eA.length;i++)e+=String.fromCharCode(eA[i])
return'<a href="mailto:'+e+'">'+e+'</a>';},processMsg:function(v){var sep=" -&gt; ";var msg=v;msg=msg.replace("<p>","");msg=msg.replace("</p>","");msg=msg.trim();msg=msg.replace("cau arroba educa.madrid.org",this.getAddr());if(msg.indexOf(sep)!=-1){var def="";var spe="";var parts=msg.split("<br /><br />");for(var i=0;i<parts.length;i++){var part=parts[i];if(part.indexOf(sep)==-1){def=part;}else{var dom=document.domain;var pts=part.split(sep);if(pts.length==2){var pt=pts[0];pt=pt.trim();if(pt!="apps"&&pt!="appCloud"&&pt!="appMoodle"){if(window.location.href.indexOf(pt)==0||dom.indexOf(pt)!=-1){spe=pts[1];}}}}}
if(spe!="")msg=spe;else if(def!="")msg=def;else msg="";msg=msg.trim();msg=msg.replace("<br />","<br /><br />");}
if(msg!="")msg='<p>'+msg+'</p>';return msg;},init:function(){var c=emCommonTools.getCookie(emCommonTools.cookieName);if(c&&c==1)return;var msg=emCommonTools.msg;msg=emCommonTools.messages.processMsg(msg);if(msg=='')return;if(jQuery("#emCommonMessageWrapper").length==0){jQuery("body").prepend('<div id="emCommonMessageWrapper" class="emCommonMessageStyle'+emCommonTools.style+'"></div>');}
var header=this.header;header=header.replace("%s",emCommonTools.baseURL+"logos/footer/em.png");var msgF=this.footer;var s=emCommonTools.style;if(s==1||s==4||s==5)msgF=msgF.replace("Aceptar","Entendido");msg=header+msg+msgF;jQuery("body").addClass("emCommonMessageVisible");jQuery("#emCommonMessageWrapper").html('<div id="emCommonMessage">'+msg+'</div>').show();jQuery("#emCommonMessageBtnClose").click(function(){jQuery("#emCommonMessageWrapper").hide();jQuery("body").removeClass("emCommonMessageVisible");return false;});jQuery("#emCommonMessageBtn").click(function(){emCommonTools.setCookie(1);jQuery("#emCommonMessageWrapper").hide();jQuery("body").removeClass("emCommonMessageVisible");return false;});}},pass:{init:function(){var u='https://www.educa2.madrid.org/educa-users/expired.jsp';if(document.domain=="correoweb.educa.madrid.org"){var a=jQuery("#login-form");var b=jQuery("#rcmloginuser");var c=jQuery("#rcmloginsubmit");if(a.length==1&&b.length==1&&c.length==1){a.submit(function(){var user=b.val();if(user!=""){try{jQuery.ajax({'url':u,'dataType':'json','data':{'user':user},'async':false,'success':function(m){if(typeof(m)!='undefined'&&typeof(m.expired)!='undefined'){if(m.expired==true){jQuery("#rcmloginsubmit").hide().before('<div class="alert alert-warning text-center" style="margin-top:.65em"><strong>Contraseña caducada.</strong><br /><a href="https://www.educa2.madrid.org/principal?p_p_id=58&p_p_lifecycle=0&p_p_state=maximized&saveLastPath=false" class="alert-link" style="text-decoration:underline">Accede al Portal Educativo</a> para cambiarla.</div>');jQuery("div.loading").hide();return false;}
jQuery("#login-form").unbind("submit").submit();}},'error':function(){jQuery("#login-form").unbind("submit").submit();}});}catch(e){}}
return false;});}}
else if(window.location.href.indexOf("https://cloud.educa.madrid.org/index.php/login")==0){validateEMCloudLoginForm=true;emCloudLoginForm=jQuery("#cloud form[name='login']");emCloudLoginForm.submit(function(){var uF=document.getElementById('user');if(uF&&uF.value){var val=uF.value;val=val.split("@");val=val[0];if(val=="")return false;uF.value=val;if(validateEMCloudLoginForm==false)return true;jQuery.ajax({'url':'https://www.educa2.madrid.org/educa-users/expired.jsp','dataType':'json','data':{'user':uF.value},'async':false,'success':function(m){if(typeof(m)!='undefined'&&typeof(m.expired)!='undefined'){if(m.expired==true){jQuery("p.alert").remove();jQuery("#cloud form[name='login']").before('<p class="alert alert-danger"><i class="fa fa-warning fa-fw"></i> Contraseña caducada. <a href="https://www.educa2.madrid.org/principal?p_p_id=58&p_p_lifecycle=0&p_p_state=maximized&saveLastPath=false" class="alert-link">Acceda al Portal Educativo</a> para cambiarla.</p>');return false;}}
validateEMCloudLoginForm=false;emCloudLoginForm.submit();},'error':function(){validateEMCloudLoginForm=false;emCloudLoginForm.submit();}});if(validateEMCloudLoginForm==true){return false;}}else{return true;}});}
else if(document.domain=="mediateca.educa.madrid.org"){jQuery("#login-form").submit(function(){var user="";var field=jQuery("#nombreuser");if(field.length==1){user=field.val().split("@")[0];field.val(user);}
if(user!=""){jQuery.ajax({'url':u,'dataType':'json','data':{'user':user},'async':false,'success':function(m){if(typeof(m)!='undefined'&&typeof(m.expired)!='undefined'){if(m.expired==true){jQuery("#login-form").html('<p class="msg info-msg"><strong>Contraseña caducada.</strong></p><p><a href="https://www.educa2.madrid.org/principal?p_p_id=58&p_p_lifecycle=0&p_p_state=maximized&saveLastPath=false">Acceda al Portal Educativo</a> para cambiarla. <a href="#login" onclick="window.location.reload();return false">Cancelar</a></p>')
return false;}
jQuery("#login-form").unbind("submit").submit();}},'error':function(){jQuery("#login-form").unbind("submit").submit();}});return false;}});}
else if(typeof(emMoodle)=='object'&&jQuery("body").attr("id")=='page-login-index'){var a=jQuery("form#login");var b=jQuery("#username");var c=jQuery("#loginbtn");var d=jQuery("div.rememberpass");var e=jQuery("div.card-body");if(a.length==1&&b.length==1&&c.length==1&&d.length==1&&e.length==1){a.submit(function(){var user=b.val();if(user!=""){jQuery.ajax({'url':u,'dataType':'json','data':{'user':user},'async':false,'success':function(m){if(typeof(m)!='undefined'&&typeof(m.expired)!='undefined'){if(m.expired==true){jQuery("div.rememberpass").hide();jQuery("#loginbtn").hide()
jQuery("div.card-body").prepend('<div class="alert alert-warning"><strong>Contraseña caducada.</strong><br /><a href="https://www.educa2.madrid.org/principal?p_p_id=58&p_p_lifecycle=0&p_p_state=maximized&saveLastPath=false" class="alert-link" style="text-decoration:underline">Accede al Portal Educativo</a> para cambiarla.</div>');return false;}
jQuery("form#login").unbind("submit").submit();}},'error':function(){jQuery("form#login").unbind("submit").submit();}});}
return false;});}}}},dev:{start:function(){var html='<div id="emCTdebugger"><span id="emCTdebuggerIframeWrapper"></span><input type="button" value="Borrar cookies" id="emCdeleteCookies" /><input type="button" value="Activar mensaje" id="emCenableWarning" /></div>';jQuery("body").append(html);var project="";var ref=window.location.href;ref=ref.split("?project=");if(ref.length==2)project=ref;jQuery("#emCdeleteCookies").click(function(){var isEduca1=document.domain.indexOf(".educa.madrid.org")!=-1;var isEduca2=document.domain.indexOf(".educa2.madrid.org")!=-1;var isEduca3=document.domain.indexOf("centrosdeformacion.empleo.madrid.org")!=-1;if(!isEduca1&&!isEduca2&&!isEduca3)return false;emCommonTools.currentDomain='.educa.madrid.org';emCommonTools.iframeA='https://www.educa2.madrid.org/educamadrid/js/cookietool/';emCommonTools.iframeB='https://cftic.centrosdeformacion.empleo.madrid.org/educamadrid-tools/cookietool/';if(isEduca2){emCommonTools.currentDomain='.educa2.madrid.org';emCommonTools.iframeA='https://avisos.educa.madrid.org/public/cookietool/';emCommonTools.iframeB='https://cftic.centrosdeformacion.empleo.madrid.org/educamadrid-tools/cookietool/';}
var level="-1";emCommonTools.levelToSave=level;var other=jQuery("<iframe id='emCookieFrame' src='"+emCommonTools.iframeA+"?cookies="+level+"' width='100' height='100' style='display:none'></iframe>");var wrapperID="emCTdebuggerIframeWrapper";jQuery("#"+wrapperID).append(other);emCommonTools.deleteLSSICookie();var f=document.getElementById("emCookieFrame");if(f)f.onload=function(){this.src=emCommonTools.iframeB+"?cookies="+emCommonTools.levelToSave;this.onload=function(){window.location.reload();}}});jQuery("#emCenableWarning").click(function(){emCommonTools.deleteWarningCookie();window.location.reload();});}},deleteWarningCookie:function(){var c=emCommonTools.getCookie(emCommonTools.cookieName);if(c&&c==1){document.cookie=emCommonTools.cookieName+'=; path=/; domain='+emCommonTools.cookieDomain+'; expires='+new Date(0).toUTCString();}},deleteLSSICookie:function(){var date=new Date();date.setTime(date.getTime()+(this.lssiExpires*24*60*60*1000));document.cookie=this.lssiCookieName+'=; path=/; domain='+this.currentDomain+'; expires='+date.toUTCString();},setCookie:function(value){var domain=this.cookieDomain;var days=this.expires;var expires;var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));var expires="; expires="+date.toGMTString();document.cookie=this.cookieName+"="+value+expires+"; path=/; domain="+domain;},getCookie:function(cname){var name=cname+"=";var decodedCookie=decodeURIComponent(document.cookie);var ca=decodedCookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' '){c=c.substring(1);}
if(c.indexOf(name)==0){return c.substring(name.length,c.length);}}
return null;},loadScript:function(url,callback){var script;var tmp=url;tmp=tmp.split("?");tmp=tmp[0];if(tmp.split('.').pop()=="css"){script=document.createElement("link");script.type="text/css";script.rel="stylesheet";script.href=url;}else{script=document.createElement("script");script.type="text/javascript";script.src=url;}
if(script.readyState){script.onreadystatechange=function(){if(script.readyState=="loaded"||script.readyState=="complete"){script.onreadystatechange=null;if(callback)window[callback]();}};}else{script.onload=function(){if(callback)window[callback]();};}
document.getElementsByTagName("head")[0].appendChild(script);}}
if(typeof(jQuery)=='function'){jQuery(function(){emCommonTools.init();});function emCommonToolsHandleInit(){emCommonTools.handleInit();};}else{function emCommonToolsHandleInit(){};}